<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tecnologia</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(120deg, #f7bcbb 0%, #be1818 100%);
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ea534e;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .logo:hover {
            color: #be1818;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-item a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
            padding: 10px 15px;
            border-radius: 25px;
        }

        .nav-item a:hover {
            color: #ea534e;
            background: rgba(102, 126, 234, 0.1);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 4px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: #333;
            transition: 0.3s;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .home-view {
            display: block;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 60px;
            background: rgba(255, 255, 255, 0.95);
            padding: 60px 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            color: #2d3748;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.5rem;
            color: #ea534e;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .hero-description {
            font-size: 1.1rem;
            color: #4a5568;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .activities-section {
            margin-top: 40px;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            color: white;
            margin-bottom: 40px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .activities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .activity-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #ea534e, #be1818);
        }

        .activity-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .activity-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .activity-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .activity-description {
            color: #4a5568;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .activity-button {
            background: linear-gradient(135deg, #ea534e, #be1818);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .activity-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .activity-detail {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
        }

        .detail-header {
            margin-bottom: 30px;
        }

        .back-button {
            background: rgba(102, 126, 234, 0.1);
            color: #ea534e;
            border: 2px solid #ea534e;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: #ea534e;
            color: white;
        }

        .detail-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .session-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-button {
            background: rgba(102, 126, 234, 0.1);
            color: #ea534e;
            border: 2px solid #ea534e;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .tab-button:hover, .tab-button.active {
            background: #ea534e;
            color: white;
        }

        .content-section {
            display: none;
            line-height: 1.8;
        }

        .content-section.active {
            display: block;
        }

        .content-section h3 {
            color: #2d3748;
            font-size: 1.8rem;
            margin-bottom: 25px;
            border-bottom: 3px solid #ea534e;
            padding-bottom: 10px;
        }

        .content-section h4 {
            color: #ea534e;
            font-size: 1.3rem;
            margin: 25px 0 15px 0;
        }

        .content-section p {
            margin-bottom: 15px;
            color: #4a5568;
        }

        .content-section ul {
            margin-bottom: 20px;
            padding-left: 25px;
        }

        .content-section li {
            margin-bottom: 10px;
            color: #4a5568;
        }

        .info-box {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #ea534e;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }

        .info-box h5 {
            color: #ea534e;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .info-box p {
            margin: 0;
            color: #4a5568;
        }

        .highlight-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .highlight-box h4 {
            color: #2d3748;
            margin-bottom: 15px;
        }

        

        /* Genetic Algorithm Styles */
                .controls-panel, .stats-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            height: fit-content;
        }

        .panel-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #4facfe;
            padding-bottom: 5px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4facfe;
            cursor: pointer;
        }

        .slider-value {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            color: #4facfe;
        }

        .button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: transform 0.2s;
        }

        .button:hover {
            transform: translateY(-2px);
        }

        .button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .visualization-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .grid-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        #gameCanvas {
            border: 2px solid #ddd;
            border-radius: 8px;
            display: block;
            margin: 0 auto;
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .legend {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin-right: 10px;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px;
            background: white;
            border-radius: 5px;
        }

        .stats-value {
            font-weight: bold;
            color: #4facfe;
        }

        .best-solution {
            background: #e8f5e8;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .movement-sequence {
            font-family: monospace;
            font-size: 1.2em;
            margin-top: 10px;
            word-break: break-all;
        }

        .explanation {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
        }
        /* Comic Slideshow */
        .comic-slideshow {
            background: linear-gradient(135deg, rgba(255, 145, 139, 0.1), rgba(255, 220, 218, 0.3));
            padding: 40px;
            border-radius: 20px;
            border: 3px solid #f28f8c;
            text-align: center;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
        }

        .comic-frame {
            display: none;
            background: white;
            border: 4px solid #e41513;
            border-radius: 15px;
            padding: 30px;
            margin: 20px auto;
            max-width: 600px;
            box-shadow: 0 8px 25px rgba(255, 29, 17, 0.2);
            position: relative;
        }

        .comic-frame.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .comic-frame::before {
            content: '';
            position: absolute;
            top: -10px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 15px solid #e41513;
        }

        .comic-character {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
        }

        .comic-text {
            font-size: 1.1rem;
            color: #53110e;
            line-height: 1.6;
            font-weight: 500;
        }

        .comic-controls {
            margin-top: 25px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .comic-btn {
            background: linear-gradient(135deg, #f28f8c, #e52920);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .comic-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px #9d1915;
        }

        .comic-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .comic-progress {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 145, 139, 0.3);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: #f28f8c;
            transform: scale(1.2);
        }

        .cell-diagram {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            position: relative;
            background: radial-gradient(circle, #E9F8FF, #92C9F9);
            border-radius: 50%;
            border: 4px solid #f7bcbb;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cell-diagram:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(146, 201, 249, 0.4);
        }

        .nucleus {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #f7bcbb, #92C9F9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: 0 8px 25px rgba(255, 142, 142, 0.3);
        }
        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }

            .nav-menu {
                position: fixed;
                left: -100%;
                top: 70px;
                flex-direction: column;
                background: rgba(255, 255, 255, 0.95);
                width: 100%;
                text-align: center;
                transition: 0.3s;
                box-shadow: 0 10px 27px rgba(0,0,0,0.05);
                backdrop-filter: blur(10px);
                padding: 20px 0;
            }

            .nav-menu.active {
                left: 0;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1.2rem;
            }

            .activities-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .main-content {
                padding: 20px 15px;
            }

            .hero-section {
                padding: 40px 20px;
            }

           
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <a href="#" class="logo" onclick="showHome()">Tecnologia</a>
            <ul class="nav-menu" id="navMenu">
                <li class="nav-item"><a href="#" onclick="showHome()"> Inici</a></li>
                <li class="nav-item"><a href="#" onclick="showSection('activitat1')"> Activitat 1</a></li>
                <li class="nav-item"><a href="#" onclick="showSection('activitat2')"> Activitat 2</a></li>
                <li class="nav-item"><a href="#" onclick="showSection('activitat3')"> Activitat 3</a></li>
                <li class="nav-item"><a href="inici.html" onclick="showSection('procediment')">Les altres cares de la ciència</a></li>
            </ul>
            <div class="hamburger" id="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <main class="main-content">
        <!-- Home Page -->
        <div id="home" class="home-view">
            <div class="hero-section">
                <h1 class="hero-title">Tecnologia</h1>
                <p class="hero-subtitle">Activitats de tecnologia per conèixer les eines tecnològiques que fan possible la ciència.</p>
                <p class="hero-description">Una col·lecció d'activitats educatives per introduir els conceptes fonamentals del pensament computacional, els algoritmes i la resolució de problemes tecnològics de manera pràctica.</p>
            </div>
            
            <div class="activities-section">
                <h2 class="section-title">📚 Continguts del curs</h2>
                <div class="activities-grid">
                    

                    <div class="activity-card" onclick="showSection('activitat1')">
                        <div class="activity-icon">🎯</div>
                        <h3 class="activity-title">Activitat 1</h3>
                        <p class="activity-description">Primera aproximació als algoritmes amb exercicis pràctics i exemples quotidians.</p>
                        <button class="activity-button">Explorar</button>
                    </div>

                    <div class="activity-card" onclick="showSection('activitat2')">
                        <div class="activity-icon">🧩</div>
                        <h3 class="activity-title">Activitat 2</h3>
                        <p class="activity-description">Desenvolupament del pensament lògic mitjançant la resolució de problemes estructurats.</p>
                        <button class="activity-button">Descobrir</button>
                    </div>

                    <div class="activity-card" onclick="showSection('activitat3')">
                        <div class="activity-icon">🚨</div>
                        <h3 class="activity-title">Ruta d'emergència</h3>
                        <p class="activity-description">Trobar el camí més ràpid utilitzant algoritmes d'optimització en situacions d'emergència.</p>
                        <button class="activity-button">Començar</button>
                    </div>
                </div>
            </div>
        </div>

        

        <!-- Activitat 1 Section -->
        <div id="activitat1" class="activity-detail">
            <div class="detail-header">
                <button class="back-button" onclick="showHome()">← Tornar a l'inici</button>
                <h2 class="detail-title">🎯 Activitat 1</h2>
            </div>
            
            <div class="session-tabs">
                <button class="tab-button active" onclick="showTab('activitat1', 'professorat1')">👩‍🏫 Guia del professorat</button>
                <button class="tab-button" onclick="showTab('activitat1', 'alumnat1')">🎓 Introducció per l'alumnat</button>
            </div>

            <div id="professorat1" class="content-section active">
                <h3>👩‍🏫 Guia del professorat - Activitat 1</h3>
                <p>Contingut de la guia del professorat per a la primera activitat...</p>
                
                <h4>🎯 Objectius</h4>
                <ul>
                    <li>Introduir els conceptes bàsics d'algoritme</li>
                    <li>Desenvolupar el pensament seqüencial</li>
                    <li>Practicar la descomposició de problemes</li>
                </ul>

                <div class="info-box">
                    <h5>📋 Materials necessaris</h5>
                    <p>Llapis, paper, targetes d'instruccions, cronòmetre</p>
                </div>
            </div>

            <div id="alumnat1" class="content-section">
                <h3>🎓 Introducció per l'alumnat - Activitat 1</h3>
                <p>Benvinguts a la primera activitat de pensament computacional...</p>
            </div>
        </div>

        <!-- Activitat 2 Section -->
        <div id="activitat2" class="activity-detail">
            <div class="detail-header">
                <button class="back-button" onclick="showHome()">← Tornar a l'inici</button>
                <h2 class="detail-title"> Activitat 2</h2>
            </div>
            
            <div class="session-tabs">
                <button class="tab-button active" onclick="showTab('activitat2', 'professorat2')">👩‍🏫 Guia del professorat</button>
                <button class="tab-button" onclick="showTab('activitat2', 'alumnat2')">🎓 Introducció per l'alumnat</button>
            </div>

            <div id="professorat2" class="content-section active">
                <h3> Guia del professorat - Activitat 2</h3>
                
                <h4> Petit resum</h4>
                <p>Aquesta activitat introdueix l'alumnat a l'ús d'eines d'intel·ligència artificial aplicades a la biologia, a través d'AlphaFold, un sistema capaç de predir l'estructura tridimensional de proteïnes a partir de la seva seqüència d'aminoàcids. L'alumnat visualitzarà o generarà una predicció real d'una proteïna, analitzarà la seva estructura i reflexionarà sobre la relació entre seqüència i funció biològica.</p>

                <h4> Objectius</h4>
                <ul>
                    <li>Entendre què és i com funciona AlphaFold com a eina de predicció d'estructures proteiques</li>
                    <li>Comprendre la relació entre la seqüència d'aminoàcids i l'estructura tridimensional de les proteïnes</li>
                    <li>Reconèixer com el plegament de proteïnes condiciona la seva funció dins del cos</li>
                    <li>Identificar l'impacte de les noves tecnologies (IA) en la investigació biomèdica</li>
                    <li>Utilitzar eines basades en intel·ligència artificial per fer prediccions moleculars</li>
                </ul>

                <h4> Competències treballades</h4>
                <div class="highlight-box">
                    <ul>
                        <li><strong>Competència digital:</strong> ús d'eines d'IA i plataformes científiques online</li>
                        <li><strong>Competència en ciències i tecnologia:</strong> comprensió de processos biològics i aplicacions tecnològiques</li>
                        <li><strong>Aprendre a aprendre:</strong> interpretació de resultats científics i anàlisi crítica</li>
                        <li><strong>Competència matemàtica:</strong> comprensió d'estructures tridimensionals i patrons</li>
                    </ul>
                </div>

                <h4>⏱ Materials necessaris i durada</h4>
                <div class="info-box">
                    <h5>Durada: 60 minuts</h5>
                    <p><strong>Materials:</strong></p>
                    <ul>
                        <li>Ordinadors amb accés a internet</li>
                        <li>Accés a <a href="https://alphafoldserver.com/" target="_blank">AlphaFold Server</a> o ColabFold</li>
                        <li>Seqüències d'aminoàcids d'exemple</li>
                        <li>Alternativament: prediccions fetes prèviament per mostrar</li>
                    </ul>
                </div>

                <h4> Què és AlphaFold?</h4>
                <p>AlphaFold és un programa d'intel·ligència artificial desenvolupat per DeepMind (Google) que pot predir la forma tridimensional d'una proteïna només a partir de la seva seqüència d'aminoàcids. Fins ara, descobrir l'estructura real d'una proteïna era molt lent, car i difícil (cristal·lografia de raigs X o criomicroscòpia electrònica). Ara, amb AlphaFold, es poden fer milions de prediccions molt precises en pocs minuts.</p>

                <h4> Com funciona AlphaFold:</h4>
                <ol>
                    <li>Llegeix la seqüència d'aminoàcids d'una proteïna</li>
                    <li>Compara amb moltes altres que ja coneix</li>
                    <li>Utilitza intel·ligència artificial per predir com es plega</li>
                    <li>Dona com a resultat una estructura 3D molt aproximada a la real</li>
                </ol>

                <h4> Passos de l'activitat:</h4>
                <ol>
                    <li>Ves a <a href="https://alphafoldserver.com/" target="_blank">https://alphafoldserver.com/</a></li>
                    <li>Copia la seqüència en el camp corresponent i executa</li>
                    <li>El programa trigarà uns minuts i et donarà una estructura predita</li>
                    <li>Observa el model en 3D i analitza'l amb els alumnes</li>
                </ol>

                <h4> Preguntes per reflexionar:</h4>
                <ul>
                    <li>Com creus que una seqüència d'aminoàcids pot acabar formant una estructura tan complexa?</li>
                    <li>Quins avantatges pot tenir preveure l'estructura d'una proteïna sense haver de fer experiments?</li>
                    <li>Si una proteïna està mal plegada, què podria passar al cos humà?</li>
                    <li>Creus que AlphaFold podria ajudar a curar malalties? Per què?</li>
                </ul>
            </div>

            <div id="alumnat2" class="content-section">
                <h3> Activitat 2: Predir el plegament amb Intel·ligència Artificial</h3>
                
                <div class="highlight-box">
                    <h4> La teva missió com a bioinformàtic:</h4>
                    <p>Imagina que ets part d'un equip pioner de bioinformàtics i tens entre mans una seqüència d'aminoàcids d'una proteïna desconeguda. Ningú no sap com és ni com funciona. La teva missió és fer servir la tecnologia més avançada: <strong>AlphaFold</strong>, un sistema d'intel·ligència artificial capaç de predir l'estructura d'una proteïna abans que ningú l'hagi vist mai!</p>
                </div>

                <h4> Què faràs en aquesta activitat:</h4>
                <ul>
                    <li>Introduir la seqüència al sistema de predicció</li>
                    <li>Entendre com AlphaFold pren decisions</li>
                    <li>Analitzar la forma predita, zones estables i possibles parts actives</li>
                    <li>Comparar amb versions mutades per veure com pot afectar la funció</li>
                </ul>

                <h4> Què vol dir que una proteïna es plega?</h4>
                <p>Imagina't que la proteïna és com una cadena llarga de comptes de colors (cada compte seria un aminoàcid). Aquesta cadena no queda estirada, sinó que es doblega sobre si mateixa, es cargola, es doblega en angles concrets… fins a tenir una forma tridimensional molt específica. Aquest procés s'anomena <strong>plegament de la proteïna</strong>.</p>

                <div class="info-box">
                    <h5> Per què és important aquesta forma?</h5>
                    <p>La funció d'una proteïna depèn de la seva forma. Si la proteïna no es plega bé, no podrà fer la seva feina o pot fins i tot fer mal.</p>
                    <p><strong>Exemple senzill:</strong> Pensa en una clau i un pany. La proteïna seria la clau, i ha de tenir la forma exacta per encaixar al pany (una altra molècula o part del cos). Si la clau està torta o mal feta, no obrirà res.</p>
                </div>

                <!-- AlphaFold Workflow Infographic -->
                <div class="alphafold-workflow" style="margin: 30px 0;">
                    <h4> Com funciona AlphaFold:</h4>
                    <div style="display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, #f0f9ff, #e0f2fe); padding: 25px; border-radius: 15px; margin: 20px 0; flex-wrap: wrap; gap: 15px;">
                        <div style="text-align: center; flex: 1; min-width: 150px;">
                            <div style="width: 80px; height: 80px; background: #3b82f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-size: 2rem;">🧬</div>
                            <h5 style="color: #1e40af; margin-bottom: 8px;">1. Entrada</h5>
                            <p style="font-size: 0.9rem; color: #475569; margin: 0;">Seqüència d'aminoàcids</p>
                        </div>
                        <div style="font-size: 2rem; color: #64748b;">→</div>
                        <div style="text-align: center; flex: 1; min-width: 150px;">
                            <div style="width: 80px; height: 80px; background: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-size: 2rem;">🧠</div>
                            <h5 style="color: #059669; margin-bottom: 8px;">2. IA</h5>
                            <p style="font-size: 0.9rem; color: #475569; margin: 0;">Xarxa neuronal</p>
                        </div>
                        <div style="font-size: 2rem; color: #64748b;">→</div>
                        <div style="text-align: center; flex: 1; min-width: 150px;">
                            <div style="width: 80px; height: 80px; background: #f59e0b; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-size: 2rem;">📊</div>
                            <h5 style="color: #d97706; margin-bottom: 8px;">3. Comparació</h5>
                            <p style="font-size: 0.9rem; color: #475569; margin: 0;">Bases de dades</p>
                        </div>
                        <div style="font-size: 2rem; color: #64748b;">→</div>
                        <div style="text-align: center; flex: 1; min-width: 150px;">
                            <div style="width: 80px; height: 80px; background: #8b5cf6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-size: 2rem;">🏗️</div>
                            <h5 style="color: #7c3aed; margin-bottom: 8px;">4. Sortida</h5>
                            <p style="font-size: 0.9rem; color: #475569; margin: 0;">Estructura 3D</p>
                        </div>
                    </div>
                </div>

                <!-- Step-by-step Instructions Panel -->
                <div class="instructions-panel" style="background: #f8fafc; border-radius: 15px; padding: 25px; margin: 30px 0; border: 2px solid #e2e8f0;">
                    <h4> Instruccions pas a pas:</h4>
                    <div style="display: grid; gap: 20px; margin-top: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="width: 40px; height: 40px; background: #3b82f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">1</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #1e40af;">📋 Copia la seqüència</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">Selecciona una seqüència d'aminoàcids d'exemple</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="width: 40px; height: 40px; background: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">2</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #059669;">🌐 Ves a la web</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">Accedeix a <a href="https://alphafoldserver.com/" target="_blank" style="color: #3b82f6;">alphafoldserver.com</a></p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="width: 40px; height: 40px; background: #f59e0b; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">3</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #d97706;">▶️ Executa la predicció</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">Enganxa la seqüència i prem el botó d'executar</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="width: 40px; height: 40px; background: #8b5cf6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">4</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #7c3aed;">🔍 Interpreta els resultats</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">Analitza l'estructura 3D predita i les seves característiques</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Glossary -->
                <div class="glossary-section" style="background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 15px; padding: 25px; margin: 30px 0;">
                    <h4> Glossari de termes:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: #d97706; margin: 0 0 8px 0;">🧬 Plegament</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Procés pel qual una proteïna adopta la seva forma tridimensional funcional</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: #d97706; margin: 0 0 8px 0;">🔗 Aminoàcid</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Molècula bàsica que forma les proteïnes, com els "comptes" d'un collar</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: #d97706; margin: 0 0 8px 0;">🏗️ Estructura secundària</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Formes locals de la proteïna com hèlixs i làmines</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: #d97706; margin: 0 0 8px 0;">🤖 AlphaFold</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Sistema d'IA de DeepMind que prediu estructures de proteïnes</p>
                        </div>
                    </div>
                </div>

                <!-- Historical Context -->
                <div class="history-section" style="background: #f0f9ff; border-radius: 15px; padding: 25px; margin: 30px 0; border-left: 5px solid #3b82f6;">
                    <h4> Context històric: La revolució d'AlphaFold</h4>
                    <div style="margin-top: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <div style="width: 60px; height: 60px; background: #3b82f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white;">🧪</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #1e40af;">Abans d'AlphaFold</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">Determinar l'estructura d'una proteïna podia trigar anys i costar milers d'euros</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <div style="width: 60px; height: 60px; background: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white;">🚀</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #059669;">2020: El gran avenç</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">AlphaFold aconsegueix una precisió del 90% en la predicció d'estructures</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="width: 60px; height: 60px; background: #8b5cf6; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white;">🌍</div>
                            <div>
                                <h5 style="margin: 0 0 5px 0; color: #7c3aed;">Avui</h5>
                                <p style="margin: 0; color: #64748b; font-size: 0.9rem;">Més de 200 milions d'estructures predites i disponibles gratuïtament</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Medical Applications -->
                <div class="medical-applications" style="background: linear-gradient(135deg, #ecfdf5, #d1fae5); border-radius: 15px; padding: 25px; margin: 30px 0;">
                    <h4> Aplicacions mèdiques d'AlphaFold:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="font-size: 2rem; margin-bottom: 10px;">🦠</div>
                            <h5 style="color: #059669; margin-bottom: 10px;">COVID-19</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Predicció de proteïnes del virus per desenvolupar vacunes i tractaments</p>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="font-size: 2rem; margin-bottom: 10px;">🧠</div>
                            <h5 style="color: #059669; margin-bottom: 10px;">Alzheimer</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Comprendre com es pleguen malament les proteïnes en malalties neurodegeneratives</p>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="font-size: 2rem; margin-bottom: 10px;">💊</div>
                            <h5 style="color: #059669; margin-bottom: 10px;">Nous medicaments</h5>
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">Disseny de fàrmacs més efectius basats en l'estructura de les proteïnes diana</p>
                        </div>
                    </div>
                </div>

                <!-- Connection Map -->
                <div class="connection-map" style="background: #fefce8; border-radius: 15px; padding: 25px; margin: 30px 0; text-align: center;">
                    
                    <div style="display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 20px; margin-top: 20px;">
                        <div style="background: #3b82f6; color: white; padding: 15px 20px; border-radius: 25px; font-weight: bold;"> Intel·ligència Artificial</div>
                        <div style="font-size: 1.5rem;">+</div>
                        <div style="background: #10b981; color: white; padding: 15px 20px; border-radius: 25px; font-weight: bold;"> Biologia</div>
                        <div style="font-size: 2rem;">→</div>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div style="background: #f59e0b; color: white; padding: 10px 15px; border-radius: 20px; font-size: 0.9rem;"> Medicaments</div>
                            <div style="background: #8b5cf6; color: white; padding: 10px 15px; border-radius: 20px; font-size: 0.9rem;"> Diagnòstic</div>
                            <div style="background: #ef4444; color: white; padding: 10px 15px; border-radius: 20px; font-size: 0.9rem;"> Recerca</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activitat 3 Section -->
        <div id="activitat3" class="activity-detail">
            <div class="detail-header">
                <button class="back-button" onclick="showHome()">← Tornar a l'inici</button>
                <h2 class="detail-title"> Ruta d'emergència: trobar el camí més ràpid</h2>
            </div>
            
            <div class="session-tabs">
                <button class="tab-button active" onclick="showTab('activitat3', 'professorat3')"> Guia del professorat</button>
                <button class="tab-button" onclick="showTab('activitat3', 'alumnat3')"> Introducció per l'alumnat</button>
            </div>

            <div id="professorat3" class="content-section active">
                <h3> Guia del professorat</h3>
                
                <h4> Petit resum</h4>
                <p>En aquesta activitat, l'alumnat es posa en la pell d'un equip d'emergències que ha de trobar el camí més ràpid per arribar a una zona afectada, evitant obstacles en una xarxa de carrers o camins. Mitjançant una representació de mapa en forma de graella, els alumnes hauran de desenvolupar una estratègia basada en passos lògics per resoldre el repte: trobar la ruta òptima. Aquesta activitat introdueix el concepte d'algoritme, potencia el pensament computacional i connecta la resolució de problemes amb situacions reals d'impacte social.</p>

                <h4> Objectius d'Aprenentatge</h4>
                <ul>
                    <li><strong>Comprendre què és un algoritme:</strong> Una seqüència de passos lògics per resoldre un problema.</li>
                    <li><strong>Entendre l'optimització:</strong> Trobar la millor solució (la ruta més ràpida/curta).</li>
                    <li><strong>Connectar amb l'impacte social:</strong> Reconèixer com els algoritmes milloren la vida quotidiana.</li>
                    <li><strong>Desenvolupar el pensament computacional:</strong> Descomposar problemes i aplicar lògica.</li>
                </ul>

                <h4> Competències treballades</h4>
                <div class="highlight-box">
                    <ul>
                        <li><strong>Competència digital:</strong> iniciació al concepte d'algoritmes i automatització.</li>
                        <li><strong>Competència matemàtica:</strong> ús d'esquemes, graelles i càlcul de distàncies.</li>
                        <li><strong>Competència en ciències i tecnologia:</strong> aplicació del pensament científic a situacions pràctiques.</li>
                        <li><strong>Aprendre a aprendre i pensament crític:</strong> descomposar problemes, explorar solucions, analitzar rutes.</li>
                    </ul>
                </div>

                <h4> Assignatures Clau</h4>
                <ul>
                    <li><strong>Tecnologia:</strong> Algoritmes, optimització, lògica.</li>
                    <li><strong>Matemàtiques:</strong> Distàncies, gràfics, resolució de problemes.</li>
                    <li><strong>Ciències Socials/Geografia:</strong> Mobilitat, gestió d'emergències, planificació territorial.</li>
                </ul>

                <h4>⏱ Materials necessaris i durada</h4>
                <div class="info-box">
                    <h5>Durada: 60 minuts</h5>
                    <p><strong>Materials:</strong></p>
                    <ul>
                        <li><strong>Mapa "Laberint Urbà/Rural" (1 còpia):</strong>
                            <ul>
                                <li>Una graella o xarxa de camins esquemàtica (5x5 o 6x6 cel·les).</li>
                                <li>Un punt clar d'Inici (I) (base d'emergències) i un de Destí (D) (punt de l'emergència).</li>
                                <li>Adaptabilitat: Pots canviar els noms de les cel·les (carrers/cruïlles per a ciutat, camins/masies per a poble).</li>
                                <li>Algunes cel·les/camins bloquejats (amb una "X" o zona fosca), representant obstacles (obres, riuades, accidents).</li>
                                <li>Cada moviment entre cel·les té un cost d'1 unitat de temps/distància.</li>
                            </ul>
                        </li>
                        <li><strong>Llapis de colors diferents:</strong> Per marcar les rutes i els números de cost.</li>
                    </ul>
                </div>

                <h4>Explicació de l'activitat</h4>

                <p>L'activitat comença amb un repte visual: els alumnes observen un mapa-laberint amb obstacles. Molts troben ràpidament un camí a simple vista i sembla fàcil. Però llavors ens fem la pregunta clau: <strong>si ja sabem la resposta, per què necessitem ordinadors per això?</strong></p>

                <p>La resposta és que, en situacions més complexes, amb moltes més opcions i variables, el cervell humà no pot considerar totes les possibilitats amb prou rapidesa. Els ordinadors poden fer milions de càlculs per segon i provar alternatives que nosaltres no podríem ni imaginar. <strong>En problemes grans o amb moltes solucions possibles, un algoritme pot trobar solucions òptimes de forma sistemàtica.</strong></p>

                <p>Per entendre com pensa un ordinador, proposem aplicar un <strong>algoritme genètic manualment</strong>, pas a pas:</p>

                <ol style="margin-left: 2rem;">
                  <li><strong>Observar el mapa:</strong> identificar l’inici, el destí i els obstacles (zones tallades).</li>
                  <li><strong>Generar una població inicial de rutes aleatòries:</strong> inventar camins, encara que no siguin bons.</li>
                  <li><strong>Avaluar cada ruta:</strong> calcular quantes caselles recorren, si passen per obstacles o si arriben al destí.</li>
                  <li><strong>Seleccionar les millors rutes:</strong> les més curtes i que més aprop són del destí.</li>
                  <li><strong>Fer creuaments:</strong> combinar parts de dues rutes bones per crear-ne de noves.</li>
                  <li><strong>Aplicar mutacions:</strong> fer petits canvis aleatoris en alguna ruta per explorar noves opcions.</li>
                  <li><strong>Repetir el procés:</strong> fer diverses generacions, esperant millores.</li>
                </ol>

                <p>Quan els alumnes ho fan a mà, veuen com de lent i limitat és aquest procés. Llavors ho comparen amb un ordinador fent exactament el mateix. I veuen que, en segons, pot fer el que a ells els costa molts minuts. <strong>Aquesta és la força dels algoritmes i el pensament computacional.</strong></p>

                <h5 style="font-size: 1.1rem;">Per què canvia el resultat cada vegada?</h5>
                <p>Un algoritme genètic comença amb rutes aleatòries i fa mutacions aleatòries. Per això, encara que el mapa sigui el mateix, el camí trobat pot ser diferent cada cop. No hi ha una única resposta "correcta", sinó una solució òptima segons la població i l'atzar inicial.</p>

                <h5 style="font-size: 1.1rem;">Què passa si...</h5>

                <ul>
                  <li><strong>Augmentem la població inicial?</strong>  
                    L'algoritme té més varietat de rutes per començar, així que pot trobar solucions millors més ràpidament. Però també necessita més temps per processar-ho tot.</li>
                
                  <li><strong>Augmentem el nombre de generacions?</strong>  
                    Li donem més oportunitats per millorar les solucions. Sovint, més generacions vol dir una solució més eficient, però hi ha un punt en què ja no millora gaire.</li>
                
                  <li><strong>Augmentem la taxa de mutació?</strong>  
                    Introduïm més diversitat, i això pot ajudar a sortir de camins dolents. Però massa mutació pot fer que perdi les bones solucions que ja tenia.</li>
                
                  <li><strong>Augmentem l’elitisme?</strong>  
                    L’elitisme fa que les millors rutes sempre passin a la següent generació. Això ajuda a mantenir la qualitat, però si és massa alt, l’algoritme pot estancar-se i deixar d'explorar rutes noves.</li>
                </ul>

                <p>A través d'aquest joc, l'alumnat entén <strong>com funcionen els algoritmes evolutius, què vol dir optimitzar, i per què la ciència i la tecnologia s’ajuden mútuament per resoldre problemes del món real.</strong></p>


                
            </div>

            <div id="alumnat3" class="content-section">
                <h3>Introducció per l'alumnat</h3>
                
                <div class="comic-slideshow">
                  <h4 style="color: #e41513; margin-bottom: 20px;">Història: Missió d’Emergència</h4>
                                
                  <div class="comic-frame active" id="frame1">
                    <span class="comic-character">🚨</span>
                    <div class="comic-text">
                      Imagina que ets part d'un equip d'emergències a la teva localitat. Acaba de passar un imprevist i alguns carrers estan bloquejats. De sobte, hi ha una emergència urgent en un punt llunyà del mapa!
                    </div>
                  </div>
                
                  <div class="comic-frame" id="frame2">
                    <span class="comic-character">🚑</span>
                    <div class="comic-text">
                      El teu vehicle és al punt d'Inici (I) de la vostra base d'emergències. Heu rebut una trucada urgent: hi ha una situació crítica al punt de Destí (D) que requereix la vostra intervenció immediata.
                    </div>
                  </div>
                
                  <div class="comic-frame" id="frame3">
                    <span class="comic-character">🚧</span>
                    <div class="comic-text">
                      Però hi ha un problema: diversos carrers estan bloquejats per accidents, obres o riuades. No podeu passar per aquests punts i heu de trobar una ruta alternativa que sigui la més ràpida possible.
                    </div>
                  </div>
                
                  <div class="comic-frame" id="frame4">
                    <span class="comic-character">🗺️</span>
                    <div class="comic-text">
                      Teniu un mapa de la zona organitzat com una graella. Cada casella representa un carrer o cruïlla, i podeu moure-us en quatre direccions: amunt, avall, esquerra i dreta. Cada moviment costa 1 unitat de temps.
                    </div>
                  </div>
                
                  <div class="comic-frame" id="frame5">
                    <span class="comic-character">🎯</span>
                    <div class="comic-text">
                      Cal arribar al punt de destí en el menor temps possible! Heu de pensar estratègicament, analitzar les opcions disponibles i trobar la ruta òptima evitant els obstacles.
                    </div>
                  </div>
                
                  <div class="comic-frame" id="frame6">
                    <span class="comic-character">🧠</span>
                    <div class="comic-text">
                      Aquest repte us ajudarà a desenvolupar el pensament computacional: aprendre a descomposar problemes, reconèixer patrons i crear algoritmes per trobar solucions eficients. Esteu preparats?
                    </div>
                  </div>
                
                  <div class="comic-controls">
                    <button class="comic-btn" onclick="changeFrame(-1)">← Anterior</button>
                    <button class="comic-btn" onclick="changeFrame(1)">Següent →</button>
                  </div>
                
                  <div class="comic-progress">
                    <div class="progress-dot active"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                  </div>
                </div>

                

                <div class="highlight-box" style="margin-top: 30px;">
                    <h4> Què fareu en aquesta activitat:</h4>
                    <ul>
                        <li>Analitzar un mapa amb obstacles</li>
                        <li>Planificar diferents rutes possibles</li>
                        <li>Calcular el cost de cada ruta</li>
                        <li>Trobar la solució òptima</li>
                        <li>Comparar la vostra solució amb un algoritme informàtic</li>
                    </ul>
                </div>

                <!-- Genetic Algorithm Visualization -->
                <div class="ga-section" style="margin-top: 40px;">
                    <h3> Algoritme Genètic en Acció</h3>
                    <p>Ara veureu com un ordinador resol aquest mateix problema utilitzant un algoritme genètic. Observeu com evoluciona la població de solucions fins trobar el camí òptim!</p>
                    
                    <!-- Controls Panel -->
                    <div class="controls-panel">
                        <div class="panel-title"> Controls</div>

                        <div class="control-group">
                            <label>Mida de la Població:</label>
                            <div class="slider-container">
                                <input type="range" id="populationSize" min="20" max="100" value="50">
                                <span class="slider-value" id="populationValue">50</span>
                            </div>
                        </div>
                    
                        <div class="control-group">
                            <label>Taxa de Mutació:</label>
                            <div class="slider-container">
                                <input type="range" id="mutationRate" min="0.01" max="0.3" step="0.01" value="0.1">
                                <span class="slider-value" id="mutationValue">0.1</span>
                            </div>
                        </div>
                    
                        <div class="control-group">
                            <label>Generacions Màximes:</label>
                            <div class="slider-container">
                                <input type="range" id="maxGenerations" min="50" max="200" value="100">
                                <span class="slider-value" id="generationsValue">100</span>
                            </div>
                        </div>
                    
                        <div class="control-group">
                            <label>Enlentir l'algoritme i veure millor el procés:</label>
                            <div class="slider-container">
                                <input type="range" id="speed" min="0" max="1000" value="200">
                                <span class="slider-value" id="speedValue">200</span>
                            </div>
                        </div>
                    
                        <div class="control-group">
                            <button class="button" id="startBtn">▶️ Iniciar</button>
                            <button class="button" id="pauseBtn" disabled>⏸️ Pausar</button>
                            <button class="button" id="resetBtn">🔄 Reiniciar</button>
                            <button class="button" id="stepBtn">👣 Pas a Pas</button>
                        </div>
                    
                        <div class="explanation">
                            <strong>Com funciona:</strong><br>
                            L'algoritme genètic crea una població de camins aleatoris i els fa evolucionar. Els millors camins es reprodueixen i muten per trobar la ruta òptima.
                        </div>
                    </div>
                
                    <!-- Visualization Area -->
                    <div class="visualization-area">
                        <div class="grid-container">
                            <canvas id="gameCanvas" width="450" height="450"></canvas>
                        </div>
                    
                        <div class="charts-container">
                            <div class="chart-container">
                                <div class="chart-title"> Evolució del Fitness</div>
                                <canvas id="fitnessChart" width="250" height="150"></canvas>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title"> Diversitat de la Població</div>
                                <canvas id="diversityChart" width="250" height="150"></canvas>
                            </div>
                        </div>
                    
                        <div class="legend">
                            <div class="panel-title"> Llegenda</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #ff69b4;"></div>
                                <span>Obstacles (edificis i contorn)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #f0f0f0;"></div>
                                <span>Carrers navegables</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: rgba(135, 206, 250, 0.3);"></div>
                                <span>Rutes alternatives</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #1e3a8a;"></div>
                                <span>Millor ruta</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #dc2626;"></div>
                                <span>Mutacions</span>
                            </div>
                            <div class="legend-item">
                                <span style="margin-left: 30px;">🟢 Arriba a l'hospital | ❌ Xoca amb paret | 🟡 Camí incomplet</span>
                            </div>
                            <div class="legend-item">
                                <span style="margin-left: 30px;">➡️ Fletxes mostren la direcció del camí</span>
                            </div>
                        </div>
                    </div>
                
                    <!-- Stats Panel -->
                    <div class="stats-panel">
                        <div class="panel-title"> Estadístiques</div>

                        <div class="stats-item">
                            <span>Generació Actual:</span>
                            <span class="stats-value" id="currentGen">0</span>
                        </div>

                        <div class="stats-item">
                            <span>Millor Distància:</span>
                            <span class="stats-value" id="bestDistance">∞</span>
                        </div>

                        <div class="stats-item">
                            <span>Millor Fitness:</span>
                            <span class="stats-value" id="bestFitness">0</span>
                        </div>

                        <div class="stats-item">
                            <span>Temps Transcorregut:</span>
                            <span class="stats-value" id="timeElapsed">0s</span>
                        </div>

                        <div class="stats-item">
                            <span>Camins Exitosos:</span>
                            <span class="stats-value" id="successfulPaths">0</span>
                        </div>
                    
                        <div class="best-solution">
                            <div class="panel-title"> Millor Solució</div>
                            <div class="stats-item">
                                <span>Distància:</span>
                                <span class="stats-value" id="solutionDistance">-</span>
                            </div>
                            <div class="stats-item">
                        <span>Fitness:</span>
                        <span class="stats-value" id="solutionFitness">-</span>
                            </div>
                            <div>
                                <strong>Seqüència de Moviments:</strong>
                                <div class="movement-sequence" id="movementSequence">-</div>
                            </div>
                        </div>
                    
                        <div class="explanation">
                            <strong>Estat Actual:</strong><br>
                            <span id="currentExplanation">Premeu "Iniciar" per començar l'evolució dels camins.</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Navigation functions
        function showHome() {
            hideAllSections();
            document.getElementById('home').style.display = 'block';
        }

        function showSection(sectionName) {
            hideAllSections();
            document.getElementById(sectionName).style.display = 'block';
        }

        function hideAllSections() {
            document.getElementById('home').style.display = 'none';
            document.getElementById('activitat1').style.display = 'none';
            document.getElementById('activitat2').style.display = 'none';
            document.getElementById('activitat3').style.display = 'none';
        }

        function toggleMenu() {
            const navMenu = document.getElementById('navMenu');
            navMenu.classList.toggle('active');
        }

        // Close mobile menu when clicking on a link
        document.querySelectorAll('.nav-item a').forEach(link => {
            link.addEventListener('click', () => {
                document.getElementById('navMenu').classList.remove('active');
            });
        });

        // Tab functionality
        function showTab(activityId, tabId) {
            // Hide all content sections for this activity
            const activity = document.getElementById(activityId);
            const contentSections = activity.querySelectorAll('.content-section');
            contentSections.forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all tab buttons for this activity
            const tabButtons = activity.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected content section
            document.getElementById(tabId).classList.add('active');

            // Add active class to clicked tab button
            event.target.classList.add('active');
        }

        

        
        // Comic
         function showContent(contentType) {
            if (contentType === 'alumne') {
                    currentFrame = 1;
                    document.querySelectorAll('.comic-frame').forEach(frame => frame.classList.remove('active'));
                    document.querySelectorAll('.progress-dot').forEach(dot => dot.classList.remove('active'));
                    document.getElementById('frame1').classList.add('active');
                    document.querySelectorAll('.progress-dot')[0].classList.add('active');
                    document.getElementById('prevBtn').disabled = true;
                    document.getElementById('nextBtn').disabled = false;
                }
         }
         let currentFrame = 1;
        const totalFrames = 5;

        function changeFrame(direction) {
            // Hide current frame
            document.getElementById(`frame${currentFrame}`).classList.remove('active');
            document.querySelectorAll('.progress-dot')[currentFrame - 1].classList.remove('active');
            
            // Update frame number
            currentFrame += direction;
            
            // Show new frame
            document.getElementById(`frame${currentFrame}`).classList.add('active');
            document.querySelectorAll('.progress-dot')[currentFrame - 1].classList.add('active');
            
            // Update button states
            document.getElementById('prevBtn').disabled = currentFrame === 1;
            document.getElementById('nextBtn').disabled = currentFrame === totalFrames;
        }
    </script>
    <script>
        // Global variables
        let canvas, ctx, fitnessCanvas, fitnessCtx, diversityCanvas, diversityCtx;
        let population = [];
        let generation = 0;
        let isRunning = false;
        let startTime = 0;
        let animationId = null;
        
        // Grid configuration
        const GRID_SIZE = 15;
        const CELL_SIZE = 30;
        const START_POS = {x: 1, y: 1};
        const END_POS = {x: 8, y: 8};
        const PATH_LENGTH = 20;
        
        // Genetic algorithm parameters
        let populationSize = 50;
        let mutationRate = 0.1;
        let maxGenerations = 100;
        let speed = 200;
        
        // Statistics
        let fitnessHistory = [];
        let diversityHistory = [];
        let bestSolution = null;
        
        // Grid with obstacles (1 = obstacle, 0 = free)
        const obstacles = Array(GRID_SIZE).fill().map(() => Array(GRID_SIZE).fill(0));
        
        // Initialize obstacles
        function initializeObstacles() {
            // Border obstacles
            for (let i = 0; i < GRID_SIZE; i++) {
                obstacles[0][i] = 1; // Top
                obstacles[GRID_SIZE-1][i] = 1; // Bottom
                obstacles[i][0] = 1; // Left
                obstacles[i][GRID_SIZE-1] = 1; // Right
            }
            
            // Internal obstacles (buildings) - More challenging layout
            const buildingPositions = [
                [3,3], [3,4], [4,3], [4,4], [5,3], [5,4], // Building 1 (larger)
                [6,2], [7,2], [8,2], [9,2], // Building 2 (longer)
                [2,6], [2,7], [3,6], [3,7], [2,8], [3,8], // Building 3 (taller)
                [10,5], [10,6], [11,5], [11,6], [12,5], [12,6], // Building 4 (wider)
                [5,9], [6,9], [7,9], [8,9], // Building 5 (longer)
                [12,3], [12,4], [13,3], [13,4], // Building 6
                [4,12], [5,12], [6,12], [7,12], // Building 7 (longer)
                [9,7], [10,7], [11,7], // Building 8 (new)
                [2,10], [3,10], [4,10], // Building 9 (new)
                [9,10], [10,10], [11,10], [12,10], // Building 10 (new)
                [6,5], [7,5], [8,5], // Building 11 (blocking center)
                [1,3], [1,4], // Building 12 (near start)
                [10,8], [11,8], [12,8], // Building 13 (new)
                [5,6], [5,7], // Building 14 (small connector)
                [9,12], [10,12], [11,12] // Building 15 (bottom)
            ];
            
            buildingPositions.forEach(([x, y]) => {
                if (x < GRID_SIZE && y < GRID_SIZE) {
                    obstacles[y][x] = 1;
                }
            });
            
            // Ensure start and end positions are free
            obstacles[START_POS.y][START_POS.x] = 0;
            obstacles[END_POS.y][END_POS.x] = 0;
        }
        
        // Individual class
        class Individual {
            constructor(genes = null) {
                this.genes = genes || this.generateRandomGenes();
                this.fitness = 0;
                this.distance = Infinity;
                this.reachedEnd = false;
                this.path = [];
                this.endPoint = null;
            }
            
            generateRandomGenes() {
                const directions = [0, 1, 2, 3]; // up, right, down, left
                return Array(PATH_LENGTH).fill().map(() => 
                    directions[Math.floor(Math.random() * directions.length)]
                );
            }
            
            calculateFitness() {
                this.path = [{x: START_POS.x, y: START_POS.y}];
                let currentPos = {x: START_POS.x, y: START_POS.y};
                let invalidMoves = 0;
                let steps = 0;
                this.collisionPoint = null;
                
                for (let i = 0; i < this.genes.length; i++) {
                    const direction = this.genes[i];
                    const newPos = this.getNewPosition(currentPos, direction);
                    
                    // Check if move is valid
                    if (this.isValidPosition(newPos)) {
                        currentPos = newPos;
                        this.path.push({...currentPos});
                        steps++;
                        
                        // Check if reached destination
                        if (currentPos.x === END_POS.x && currentPos.y === END_POS.y) {
                            this.reachedEnd = true;
                            this.distance = steps;
                            break;
                        }
                    } else {
                        invalidMoves++;
                        // Mark collision point on the wall
                        this.collisionPoint = {...newPos};
                        break;
                    }
                }
                
                this.endPoint = {...currentPos};
                
                if (this.reachedEnd) {
                    const optimalDistance = Math.abs(END_POS.x - START_POS.x) + Math.abs(END_POS.y - START_POS.y);
                    this.fitness = 100 / (1 + this.distance - optimalDistance + invalidMoves * 2);
                } else {
                    const manhattanDistance = Math.abs(currentPos.x - END_POS.x) + Math.abs(currentPos.y - END_POS.y);
                    const proximityToEnd = 1 / (1 + manhattanDistance);
                    this.fitness = proximityToEnd / (1 + manhattanDistance + invalidMoves * 1.5);
                }
                
                return this.fitness;
            }
            
            getNewPosition(pos, direction) {
                const moves = [
                    {x: 0, y: -1}, // up
                    {x: 1, y: 0},  // right
                    {x: 0, y: 1},  // down
                    {x: -1, y: 0}  // left
                ];
                
                const move = moves[direction];
                return {
                    x: pos.x + move.x,
                    y: pos.y + move.y
                };
            }
            
            isValidPosition(pos) {
                return pos.x >= 0 && pos.x < GRID_SIZE && 
                       pos.y >= 0 && pos.y < GRID_SIZE && 
                       obstacles[pos.y][pos.x] === 0;
            }
            
            mutate() {
                for (let i = 0; i < this.genes.length; i++) {
                    if (Math.random() < mutationRate) {
                        this.genes[i] = Math.floor(Math.random() * 4);
                    }
                }
            }
            
            crossover(other) {
                const crossoverPoint = Math.floor(Math.random() * PATH_LENGTH);
                const child1Genes = [...this.genes.slice(0, crossoverPoint), ...other.genes.slice(crossoverPoint)];
                const child2Genes = [...other.genes.slice(0, crossoverPoint), ...this.genes.slice(crossoverPoint)];
                
                return [new Individual(child1Genes), new Individual(child2Genes)];
            }
        }
        
        // Genetic Algorithm functions
        function initializePopulation() {
            population = [];
            for (let i = 0; i < populationSize; i++) {
                population.push(new Individual());
            }
            evaluatePopulation();
        }
        
        function evaluatePopulation() {
            population.forEach(individual => individual.calculateFitness());
            population.sort((a, b) => b.fitness - a.fitness);
            
            // Update best solution
            if (!bestSolution || population[0].fitness > bestSolution.fitness) {
                bestSolution = {...population[0]};
            }
        }
        
        function tournamentSelection() {
            const tournamentSize = 3;
            let best = population[Math.floor(Math.random() * population.length)];
            
            for (let i = 1; i < tournamentSize; i++) {
                const competitor = population[Math.floor(Math.random() * population.length)];
                if (competitor.fitness > best.fitness) {
                    best = competitor;
                }
            }
            
            return best;
        }
        
        function evolveGeneration() {
            const newPopulation = [];
            
            // Elitism: keep best 20%
            const eliteCount = Math.floor(populationSize * 0.2);
            for (let i = 0; i < eliteCount; i++) {
                newPopulation.push(new Individual([...population[i].genes]));
            }
            
            // Generate rest through crossover and mutation
            while (newPopulation.length < populationSize) {
                const parent1 = tournamentSelection();
                const parent2 = tournamentSelection();
                const [child1, child2] = parent1.crossover(parent2);
                
                child1.mutate();
                child2.mutate();
                
                newPopulation.push(child1);
                if (newPopulation.length < populationSize) {
                    newPopulation.push(child2);
                }
            }
            
            population = newPopulation;
            evaluatePopulation();
            generation++;
        }
        
        // Visualization functions
        function drawGrid() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid cells
            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    const cellX = x * CELL_SIZE;
                    const cellY = y * CELL_SIZE;
                    
                    if (obstacles[y][x] === 1) {
                        ctx.fillStyle = '#ff69b4'; // Pink for obstacles
                    } else {
                        ctx.fillStyle = '#f0f0f0'; // Light gray for free cells
                    }
                    
                    ctx.fillRect(cellX, cellY, CELL_SIZE, CELL_SIZE);
                    ctx.strokeStyle = '#ddd';
                    ctx.strokeRect(cellX, cellY, CELL_SIZE, CELL_SIZE);
                }
            }
            
            // Draw start position (ambulance)
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('🚑', START_POS.x * CELL_SIZE + CELL_SIZE/2, START_POS.y * CELL_SIZE + CELL_SIZE/2 + 7);
            
            // Draw end position (hospital)
            ctx.fillText('🏥', END_POS.x * CELL_SIZE + CELL_SIZE/2, END_POS.y * CELL_SIZE + CELL_SIZE/2 + 7);
        }
        
        function drawArrow(fromX, fromY, toX, toY, color, size = 8) {
            const angle = Math.atan2(toY - fromY, toX - fromX);
            
            // Draw arrow head
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - size * Math.cos(angle - Math.PI/6), toY - size * Math.sin(angle - Math.PI/6));
            ctx.lineTo(toX - size * Math.cos(angle + Math.PI/6), toY - size * Math.sin(angle + Math.PI/6));
            ctx.closePath();
            ctx.fill();
        }
        
        function drawPaths() {
            if (population.length === 0) return;
            
            // Draw alternative paths (semi-transparent blue) with arrows
            population.slice(1, Math.min(8, population.length)).forEach(individual => {
                if (individual.path.length > 1) {
                    ctx.strokeStyle = 'rgba(135, 206, 250, 0.4)';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(individual.path[0].x * CELL_SIZE + CELL_SIZE/2, 
                              individual.path[0].y * CELL_SIZE + CELL_SIZE/2);
                    
                    for (let i = 1; i < individual.path.length; i++) {
                        ctx.lineTo(individual.path[i].x * CELL_SIZE + CELL_SIZE/2, 
                                  individual.path[i].y * CELL_SIZE + CELL_SIZE/2);
                    }
                    ctx.stroke();
                    
                    // Draw arrows every few steps
                    for (let i = 1; i < individual.path.length; i += 2) {
                        if (i < individual.path.length) {
                            const fromX = individual.path[i-1].x * CELL_SIZE + CELL_SIZE/2;
                            const fromY = individual.path[i-1].y * CELL_SIZE + CELL_SIZE/2;
                            const toX = individual.path[i].x * CELL_SIZE + CELL_SIZE/2;
                            const toY = individual.path[i].y * CELL_SIZE + CELL_SIZE/2;
                            drawArrow(fromX, fromY, toX, toY, 'rgba(135, 206, 250, 0.6)', 6);
                        }
                    }
                }
            });
            
            // Draw best path (dark blue) with arrows
            if (population[0].path.length > 1) {
                ctx.strokeStyle = '#1e3a8a';
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.moveTo(population[0].path[0].x * CELL_SIZE + CELL_SIZE/2, 
                          population[0].path[0].y * CELL_SIZE + CELL_SIZE/2);
                
                for (let i = 1; i < population[0].path.length; i++) {
                    ctx.lineTo(population[0].path[i].x * CELL_SIZE + CELL_SIZE/2, 
                              population[0].path[i].y * CELL_SIZE + CELL_SIZE/2);
                }
                ctx.stroke();
                
                // Draw arrows for best path
                for (let i = 1; i < population[0].path.length; i++) {
                    const fromX = population[0].path[i-1].x * CELL_SIZE + CELL_SIZE/2;
                    const fromY = population[0].path[i-1].y * CELL_SIZE + CELL_SIZE/2;
                    const toX = population[0].path[i].x * CELL_SIZE + CELL_SIZE/2;
                    const toY = population[0].path[i].y * CELL_SIZE + CELL_SIZE/2;
                    drawArrow(fromX, fromY, toX, toY, '#1e3a8a', 8);
                }
            }
            
            // Draw collision points on walls and end points
            population.slice(0, Math.min(15, population.length)).forEach(individual => {
                if (individual.reachedEnd) {
                    // Green circle for successful paths
                    const x = individual.endPoint.x * CELL_SIZE + CELL_SIZE/2;
                    const y = individual.endPoint.y * CELL_SIZE + CELL_SIZE/2;
                    ctx.beginPath();
                    ctx.arc(x, y, 6, 0, 2 * Math.PI);
                    ctx.fillStyle = '#22c55e';
                    ctx.fill();
                } else if (individual.collisionPoint) {
                    // Red X for collision points on walls
                    const x = individual.collisionPoint.x * CELL_SIZE + CELL_SIZE/2;
                    const y = individual.collisionPoint.y * CELL_SIZE + CELL_SIZE/2;
                    ctx.strokeStyle = '#ef4444';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(x - 6, y - 6);
                    ctx.lineTo(x + 6, y + 6);
                    ctx.moveTo(x + 6, y - 6);
                    ctx.lineTo(x - 6, y + 6);
                    ctx.stroke();
                } else if (individual.path.length > 0) {
                    // Yellow circle for incomplete paths
                    const lastPoint = individual.path[individual.path.length - 1];
                    const x = lastPoint.x * CELL_SIZE + CELL_SIZE/2;
                    const y = lastPoint.y * CELL_SIZE + CELL_SIZE/2;
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    ctx.fillStyle = '#eab308';
                    ctx.fill();
                }
            });
        }
        
        function drawCharts() {
            // Fitness chart
            fitnessCtx.clearRect(0, 0, fitnessCanvas.width, fitnessCanvas.height);
            
            if (fitnessHistory.length > 1) {
                const maxFitness = Math.max(...fitnessHistory.map(gen => Math.max(gen.best, gen.avg, gen.worst)));
                const minFitness = Math.min(...fitnessHistory.map(gen => Math.min(gen.best, gen.avg, gen.worst)));
                const range = maxFitness - minFitness || 1;
                
                // Draw best fitness line
                fitnessCtx.strokeStyle = '#22c55e';
                fitnessCtx.lineWidth = 2;
                fitnessCtx.beginPath();
                fitnessHistory.forEach((gen, i) => {
                    const x = (i / (fitnessHistory.length - 1)) * fitnessCanvas.width;
                    const y = fitnessCanvas.height - ((gen.best - minFitness) / range) * fitnessCanvas.height;
                    if (i === 0) fitnessCtx.moveTo(x, y);
                    else fitnessCtx.lineTo(x, y);
                });
                fitnessCtx.stroke();
                
                // Draw average fitness line
                fitnessCtx.strokeStyle = '#3b82f6';
                fitnessCtx.lineWidth = 1;
                fitnessCtx.beginPath();
                fitnessHistory.forEach((gen, i) => {
                    const x = (i / (fitnessHistory.length - 1)) * fitnessCanvas.width;
                    const y = fitnessCanvas.height - ((gen.avg - minFitness) / range) * fitnessCanvas.height;
                    if (i === 0) fitnessCtx.moveTo(x, y);
                    else fitnessCtx.lineTo(x, y);
                });
                fitnessCtx.stroke();
            }
            
            // Diversity chart
            diversityCtx.clearRect(0, 0, diversityCanvas.width, diversityCanvas.height);
            
            if (diversityHistory.length > 1) {
                const maxDiversity = Math.max(...diversityHistory);
                const minDiversity = Math.min(...diversityHistory);
                const range = maxDiversity - minDiversity || 1;
                
                diversityCtx.strokeStyle = '#8b5cf6';
                diversityCtx.lineWidth = 2;
                diversityCtx.beginPath();
                diversityHistory.forEach((diversity, i) => {
                    const x = (i / (diversityHistory.length - 1)) * diversityCanvas.width;
                    const y = diversityCanvas.height - ((diversity - minDiversity) / range) * diversityCanvas.height;
                    if (i === 0) diversityCtx.moveTo(x, y);
                    else diversityCtx.lineTo(x, y);
                });
                diversityCtx.stroke();
            }
        }
        
        function calculateDiversity() {
            const uniqueGenes = new Set();
            population.forEach(individual => {
                uniqueGenes.add(individual.genes.join(','));
            });
            return uniqueGenes.size / population.length;
        }
        
        function updateStatistics() {
            const bestFitness = population[0].fitness;
            const avgFitness = population.reduce((sum, ind) => sum + ind.fitness, 0) / population.length;
            const worstFitness = population[population.length - 1].fitness;
            const diversity = calculateDiversity();
            const successfulPaths = population.filter(ind => ind.reachedEnd).length;
            
            fitnessHistory.push({best: bestFitness, avg: avgFitness, worst: worstFitness});
            diversityHistory.push(diversity);
            
            // Update UI
            document.getElementById('currentGen').textContent = generation;
            document.getElementById('bestDistance').textContent = population[0].reachedEnd ? population[0].distance : '∞';
            document.getElementById('bestFitness').textContent = bestFitness.toFixed(4);
            document.getElementById('timeElapsed').textContent = Math.floor((Date.now() - startTime) / 1000) + 's';
            document.getElementById('successfulPaths').textContent = successfulPaths;
            
            // Update best solution display
            if (bestSolution && bestSolution.reachedEnd) {
                document.getElementById('solutionDistance').textContent = bestSolution.distance;
                document.getElementById('solutionFitness').textContent = bestSolution.fitness.toFixed(4);
                
                const moveSymbols = ['↑', '→', '↓', '←'];
                const sequence = bestSolution.genes.slice(0, bestSolution.distance).map(gene => moveSymbols[gene]).join('');
                document.getElementById('movementSequence').textContent = sequence;
            }
            
            // Update explanation
            let explanation = '';
            if (generation === 0) {
                explanation = 'Generant població inicial amb camins aleatoris...';
            } else if (generation < 10) {
                explanation = `Primeres generacions: moltes col·lisions, explorant l'espai de solucions.`;
            } else if (successfulPaths === 0) {
                explanation = 'Encara no s\'han trobat camins exitosos. L\'algoritme continua explorant.';
            } else {
                explanation = `${successfulPaths} camins exitosos trobats. Optimitzant la millor ruta.`;
            }
            
            document.getElementById('currentExplanation').textContent = explanation;
        }
        
        function render() {
            drawGrid();
            drawPaths();
            drawCharts();
            updateStatistics();
        }
        
        function gameLoop() {
            if (!isRunning) return;
            
            // Check if we found a solution
            const hasSolution = population.some(individual => individual.reachedEnd);
            
            if (generation < maxGenerations && !hasSolution) {
                evolveGeneration();
                render();
                
                animationId = setTimeout(gameLoop, speed);
            } else {
                isRunning = false;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
                
                if (hasSolution) {
                    document.getElementById('currentExplanation').textContent = '🎉 Solució trobada! L\'algoritme ha trobat un camí exitós a l\'hospital.';
                } else {
                    document.getElementById('currentExplanation').textContent = 'Evolució completada! S\'ha arribat al màxim de generacions.';
                }
            }
        }
        
        // Event listeners
        function setupEventListeners() {
            // Sliders
            document.getElementById('populationSize').addEventListener('input', (e) => {
                populationSize = parseInt(e.target.value);
                document.getElementById('populationValue').textContent = populationSize;
            });
            
            document.getElementById('mutationRate').addEventListener('input', (e) => {
                mutationRate = parseFloat(e.target.value);
                document.getElementById('mutationValue').textContent = mutationRate;
            });
            
            document.getElementById('maxGenerations').addEventListener('input', (e) => {
                maxGenerations = parseInt(e.target.value);
                document.getElementById('generationsValue').textContent = maxGenerations;
            });
            
            document.getElementById('speed').addEventListener('input', (e) => {
                speed = parseInt(e.target.value);
                document.getElementById('speedValue').textContent = speed;
            });
            
            // Buttons
            document.getElementById('startBtn').addEventListener('click', () => {
                if (!isRunning) {
                    isRunning = true;
                    startTime = Date.now();
                    document.getElementById('startBtn').disabled = true;
                    document.getElementById('pauseBtn').disabled = false;
                    
                    if (population.length === 0) {
                        initializePopulation();
                        render();
                    }
                    
                    gameLoop();
                }
            });
            
            document.getElementById('pauseBtn').addEventListener('click', () => {
                isRunning = false;
                if (animationId) clearTimeout(animationId);
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
            });
            
            document.getElementById('resetBtn').addEventListener('click', () => {
                isRunning = false;
                if (animationId) clearTimeout(animationId);
                
                population = [];
                generation = 0;
                fitnessHistory = [];
                diversityHistory = [];
                bestSolution = null;
                
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
                
                // Reset UI
                document.getElementById('currentGen').textContent = '0';
                document.getElementById('bestDistance').textContent = '∞';
                document.getElementById('bestFitness').textContent = '0';
                document.getElementById('timeElapsed').textContent = '0s';
                document.getElementById('successfulPaths').textContent = '0';
                document.getElementById('solutionDistance').textContent = '-';
                document.getElementById('solutionFitness').textContent = '-';
                document.getElementById('movementSequence').textContent = '-';
                document.getElementById('currentExplanation').textContent = 'Premeu "Iniciar" per començar l\'evolució dels camins.';
                
                render();
            });
            
            document.getElementById('stepBtn').addEventListener('click', () => {
                if (!isRunning && generation < maxGenerations) {
                    if (population.length === 0) {
                        initializePopulation();
                    } else {
                        evolveGeneration();
                    }
                    render();
                }
            });
        }
        
        // Initialize application
        function init() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            fitnessCanvas = document.getElementById('fitnessChart');
            fitnessCtx = fitnessCanvas.getContext('2d');
            diversityCanvas = document.getElementById('diversityChart');
            diversityCtx = diversityCanvas.getContext('2d');
            
            initializeObstacles();
            setupEventListeners();
            render();
        }
        
        // Start the application
        window.addEventListener('load', init);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9696e49851b065fa',t:'MTc1NDIzNTQxMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
